{"ast":null,"code":"import { HttpHeaders } from \"@angular/common/http\";\nimport { of } from \"rxjs\";\nimport { catchError, map, tap } from \"rxjs/operators\";\nimport { environment } from \"../../../environments/environment\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class AuthService {\n  get user() {\n    return {\n      ...this.user\n    };\n  }\n  constructor(http) {\n    this.http = http;\n    this.baseUrl = environment.baseURL;\n  }\n  // tslint:disable-next-line: max-line-length\n  register(title, firstName, lastName, email, linkCV, englishLevel, technicalSkills, password, confirmPassword, acceptTerms) {\n    const url = `${this.baseUrl}/accounts/register`;\n    const body = {\n      title,\n      firstName,\n      lastName,\n      email,\n      linkCV,\n      englishLevel,\n      technicalSkills,\n      password,\n      confirmPassword,\n      acceptTerms\n    };\n    return this.http.post(url, body);\n  }\n  login(email, password) {\n    const url = `${this.baseUrl}/accounts/authenticate`;\n    const body = {\n      email,\n      password\n    };\n    return this.http.post(url, body).pipe(tap(resp => {\n      if (resp.id > \"0\") {\n        sessionStorage.setItem(\"token\", resp.jwtToken);\n      }\n    }), map(resp => resp.id), catchError(err => of(err.message)));\n  }\n  validarToken() {\n    const url = `${this.baseUrl}/accounts/refresh-token`;\n    const headers = new HttpHeaders({\n      \"Authorization\": `Bearer ${sessionStorage.getItem(\"token\")}`\n    });\n    return this.http.get(url, {\n      headers\n    }).pipe(map(resp => {\n      sessionStorage.setItem(\"token\", resp.jwtToken);\n      this._user = {\n        id: resp.id,\n        title: resp.title,\n        firstName: resp.firstName,\n        lastName: resp.lastName,\n        email: resp.email,\n        linkCV: resp.linkCV,\n        englishLevel: resp.englishLevel,\n        role: resp.role,\n        jwtToken: resp.jwtToken\n      };\n      return true;\n    }), catchError(() => of(false)));\n  }\n  logout() {\n    sessionStorage.clear();\n  }\n}\nAuthService.ɵfac = function AuthService_Factory(t) {\n  return new (t || AuthService)(i0.ɵɵinject(i1.HttpClient));\n};\nAuthService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: AuthService,\n  factory: AuthService.ɵfac,\n  providedIn: \"root\"\n});","map":{"version":3,"mappings":"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","names":["HttpHeaders","of","catchError","map","tap","environment","AuthService","user","constructor","http","baseURL","register","title","firstName","lastName","email","linkCV","englishLevel","technicalSkills","password","confirmPassword","acceptTerms","url","baseUrl","body","post","login","pipe","resp","id","sessionStorage","setItem","jwtToken","err","message","validarToken","headers","getItem","get","_user","role","logout","clear","factory","providedIn"],"sourceRoot":"","sources":["E:\\Grupo Mind\\Repos\\Challenge\\FrontEnd\\MindFrontENd\\src\\app\\auth\\services\\auth.service.ts"],"sourcesContent":["import { HttpClient, HttpHeaders } from \"@angular/common/http\";\nimport { Injectable } from \"@angular/core\";\nimport { of, Observable } from \"rxjs\";\nimport { catchError, map, tap } from \"rxjs/operators\";\n\nimport { environment } from \"../../../environments/environment\";\nimport { IAuthResponse, IAuthUser, IRegisterUser, IRegisterUserResponse } from \"../interfaces/interfaces\";\n\n@Injectable({\n  providedIn: \"root\"\n})\nexport class AuthService {\n  [x: string]: any;\n\n  private baseUrl: string = environment.baseURL;\n  private _user!: IAuthResponse;\n\n  get user(): IAuthUser {\n    return {...this.user};\n  }\n\n  constructor(private http: HttpClient) { }\n\n  // tslint:disable-next-line: max-line-length\n  register(title: string,\n           firstName: string,\n           lastName: string,\n           email: string,\n           linkCV: string,\n           englishLevel: string,\n           technicalSkills: string,\n           password: string,\n           confirmPassword: string,\n           acceptTerms: boolean): Observable<IRegisterUserResponse> {\n\n    const url: string = `${this.baseUrl}/accounts/register`;\n\n    const body: IRegisterUser = {\n      title,\n      firstName,\n      lastName,\n      email,\n      linkCV,\n      englishLevel,\n      technicalSkills,\n      password,\n      confirmPassword,\n      acceptTerms\n    };\n\n    return this.http.post<IRegisterUserResponse>(url, body);\n\n  }\n\n  login(email: string, password: string): Observable<IAuthResponse> {\n    const url: string = `${this.baseUrl}/accounts/authenticate`;\n\n    const body: IAuthUser = {\n      email,\n      password\n    };\n\n    return this.http.post<IAuthResponse>(url, body)\n      .pipe(\n        tap(resp => {\n          if (resp.id > \"0\") {\n            sessionStorage.setItem(\"token\", resp.jwtToken!);\n          }\n        }),\n        map(resp => resp.id),\n        catchError(err => of(err.message))\n      );\n  }\n\n  validarToken(): Observable<boolean> {\n\n    const url: string = `${this.baseUrl}/accounts/refresh-token`;\n\n    const headers: HttpHeaders = new HttpHeaders({\n      \"Authorization\": `Bearer ${sessionStorage.getItem(\"token\")}`\n    });\n\n    return this.http.get<IAuthResponse>(url, { headers })\n      .pipe(\n        map(resp => {\n\n          sessionStorage.setItem(\"token\", resp.jwtToken);\n\n          this._user = {\n            id: resp.id!,\n            title: resp.title,\n            firstName: resp.firstName,\n            lastName: resp.lastName,\n            email: resp.email!,\n            linkCV: resp.linkCV,\n            englishLevel: resp.englishLevel,\n            role: resp.role,\n            jwtToken: resp.jwtToken\n          };\n\n          return true;\n        }),\n        catchError(() => of(false))\n      );\n}\n\n  logout(): void {\n    sessionStorage.clear();\n  }\n\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}